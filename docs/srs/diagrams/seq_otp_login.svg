<?plantuml 1.2026.1?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1711px" preserveAspectRatio="none" style="width:1398px;height:1711px;background:#FFFFFF;" version="1.1" viewBox="0 0 1398 1711" width="1398px" zoomAndPan="magnify"><title>Sequence Diagram: Email OTP Verification (UC-03)</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="346.0226" x="522.3336" y="29.9659">Sequence Diagram: Email OTP Verification (UC-03)</text><rect fill="none" height="850.7504" style="stroke:#000000;stroke-width:1.5;" width="1371.6899" x="10" y="760.2562"/><rect fill="none" height="434.5902" style="stroke:#000000;stroke-width:1.5;" width="1351.6899" x="20" y="882.0802"/><g class="participant-lifeline" data-entity-uid="part1" data-qualified-name="U" id="part1-lifeline"><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="1503.8707" width="8" x="44.3089" y="124.1358"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="48" x2="48" y1="124.1358" y2="1628.0065"/></g></g><g class="participant-lifeline" data-entity-uid="part2" data-qualified-name="B" id="part2-lifeline"><g><title>Browser</title><rect fill="#000000" fill-opacity="0.00000" height="1503.8707" width="8" x="219.8761" y="124.1358"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="223.5062" x2="223.5062" y1="124.1358" y2="1628.0065"/></g></g><g class="participant-lifeline" data-entity-uid="part3" data-qualified-name="RP" id="part3-lifeline"><g><title>Register Page</title><rect fill="#000000" fill-opacity="0.00000" height="1503.8707" width="8" x="365.4002" y="124.1358"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="369.0334" x2="369.0334" y1="124.1358" y2="1628.0065"/></g></g><g class="participant-lifeline" data-entity-uid="part4" data-qualified-name="REG" id="part4-lifeline"><g><title>POST .api.auth.register</title><rect fill="#000000" fill-opacity="0.00000" height="1503.8707" width="8" x="529.2023" y="124.1358"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="532.3206" x2="532.3206" y1="124.1358" y2="1628.0065"/></g></g><g class="participant-lifeline" data-entity-uid="part5" data-qualified-name="SEND" id="part5-lifeline"><g><title>POST .api.auth.otp.send</title><rect fill="#000000" fill-opacity="0.00000" height="1503.8707" width="8" x="712.8997" y="124.1358"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="716.0841" x2="716.0841" y1="124.1358" y2="1628.0065"/></g></g><g class="participant-lifeline" data-entity-uid="part6" data-qualified-name="VERIFY" id="part6-lifeline"><g><title>POST .api.auth.otp.verify</title><rect fill="#000000" fill-opacity="0.00000" height="1503.8707" width="8" x="902.7781" y="124.1358"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="906.7154" x2="906.7154" y1="124.1358" y2="1628.0065"/></g></g><g class="participant-lifeline" data-entity-uid="part7" data-qualified-name="OTP" id="part7-lifeline"><g><title>OTP Service</title><rect fill="#000000" fill-opacity="0.00000" height="1503.8707" width="8" x="1054.4902" y="124.1358"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1057.7244" x2="1057.7244" y1="124.1358" y2="1628.0065"/></g></g><g class="participant-lifeline" data-entity-uid="part8" data-qualified-name="EMAIL" id="part8-lifeline"><g><title>Email Service</title><rect fill="#000000" fill-opacity="0.00000" height="1503.8707" width="8" x="1225.3224" y="124.1358"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1229.1745" x2="1229.1745" y1="124.1358" y2="1628.0065"/></g></g><g class="participant-lifeline" data-entity-uid="part9" data-qualified-name="DB" id="part9-lifeline"><g><title>MongoDB</title><rect fill="#000000" fill-opacity="0.00000" height="1503.8707" width="8" x="1321.5801" y="124.1358"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1325.4702" x2="1325.4702" y1="124.1358" y2="1628.0065"/></g></g><g class="participant participant-head" data-entity-uid="part1" data-qualified-name="U" id="part1-head"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.6179" x="30" y="120.0339">User</text><ellipse cx="48.3089" cy="53.5679" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M48.3089,61.5679 L48.3089,88.5679 M35.3089,69.5679 L61.3089,69.5679 M48.3089,88.5679 L35.3089,103.5679 M48.3089,88.5679 L61.3089,103.5679" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-entity-uid="part1" data-qualified-name="U" id="part1-tail"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.6179" x="30" y="1641.9725">User</text><ellipse cx="48.3089" cy="1654.5744" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M48.3089,1662.5744 L48.3089,1689.5744 M35.3089,1670.5744 L61.3089,1670.5744 M48.3089,1689.5744 L35.3089,1704.5744 M48.3089,1689.5744 L61.3089,1704.5744" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-entity-uid="part2" data-qualified-name="B" id="part2-head"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.7398" x="189.5062" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.7398" x="196.5062" y="112.0339">Browser</text></g><g class="participant participant-tail" data-entity-uid="part2" data-qualified-name="B" id="part2-tail"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.7398" x="189.5062" y="1627.0065"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.7398" x="196.5062" y="1648.9725">Browser</text></g><g class="participant participant-head" data-entity-uid="part3" data-qualified-name="RP" id="part3-head"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="104.7337" x="317.0334" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90.7337" x="324.0334" y="112.0339">Register Page</text></g><g class="participant participant-tail" data-entity-uid="part3" data-qualified-name="RP" id="part3-tail"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="104.7337" x="317.0334" y="1627.0065"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90.7337" x="324.0334" y="1648.9725">Register Page</text></g><g class="participant participant-head" data-entity-uid="part4" data-qualified-name="REG" id="part4-head"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="169.7634" x="448.3206" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="155.7634" x="455.3206" y="112.0339">POST /api/auth/register</text></g><g class="participant participant-tail" data-entity-uid="part4" data-qualified-name="REG" id="part4-tail"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="169.7634" x="448.3206" y="1627.0065"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="155.7634" x="455.3206" y="1648.9725">POST /api/auth/register</text></g><g class="participant participant-head" data-entity-uid="part5" data-qualified-name="SEND" id="part5-head"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="177.6314" x="628.0841" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="163.6314" x="635.0841" y="112.0339">POST /api/auth/otp/send</text></g><g class="participant participant-tail" data-entity-uid="part5" data-qualified-name="SEND" id="part5-tail"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="177.6314" x="628.0841" y="1627.0065"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="163.6314" x="635.0841" y="1648.9725">POST /api/auth/otp/send</text></g><g class="participant participant-head" data-entity-uid="part6" data-qualified-name="VERIFY" id="part6-head"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="182.1254" x="815.7154" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="168.1254" x="822.7154" y="112.0339">POST /api/auth/otp/verify</text></g><g class="participant participant-tail" data-entity-uid="part6" data-qualified-name="VERIFY" id="part6-tail"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="182.1254" x="815.7154" y="1627.0065"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="168.1254" x="822.7154" y="1648.9725">POST /api/auth/otp/verify</text></g><g class="participant participant-head" data-entity-uid="part7" data-qualified-name="OTP" id="part7-head"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="91.5317" x="1012.7244" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77.5317" x="1019.7244" y="112.0339">OTP Service</text></g><g class="participant participant-tail" data-entity-uid="part7" data-qualified-name="OTP" id="part7-tail"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="91.5317" x="1012.7244" y="1627.0065"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77.5317" x="1019.7244" y="1648.9725">OTP Service</text></g><g class="participant participant-head" data-entity-uid="part8" data-qualified-name="EMAIL" id="part8-head"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100.2957" x="1179.1745" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86.2957" x="1186.1745" y="112.0339">Email Service</text></g><g class="participant participant-tail" data-entity-uid="part8" data-qualified-name="EMAIL" id="part8-tail"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100.2957" x="1179.1745" y="1627.0065"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86.2957" x="1186.1745" y="1648.9725">Email Service</text></g><g class="participant participant-head" data-entity-uid="part9" data-qualified-name="DB" id="part9-head"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.2197" x="1289.4702" y="120.0339">MongoDB</text><path d="M1307.5801,69.0679 C1307.5801,59.0679 1325.5801,59.0679 1325.5801,59.0679 C1325.5801,59.0679 1343.5801,59.0679 1343.5801,69.0679 L1343.5801,95.0679 C1343.5801,105.0679 1325.5801,105.0679 1325.5801,105.0679 C1325.5801,105.0679 1307.5801,105.0679 1307.5801,95.0679 L1307.5801,69.0679" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M1307.5801,69.0679 C1307.5801,79.0679 1325.5801,79.0679 1325.5801,79.0679 C1325.5801,79.0679 1343.5801,79.0679 1343.5801,69.0679" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-entity-uid="part9" data-qualified-name="DB" id="part9-tail"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.2197" x="1289.4702" y="1641.9725">MongoDB</text><path d="M1307.5801,1656.0744 C1307.5801,1646.0744 1325.5801,1646.0744 1325.5801,1646.0744 C1325.5801,1646.0744 1343.5801,1646.0744 1343.5801,1656.0744 L1343.5801,1682.0744 C1343.5801,1692.0744 1325.5801,1692.0744 1325.5801,1692.0744 C1325.5801,1692.0744 1307.5801,1692.0744 1307.5801,1682.0744 L1307.5801,1656.0744" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M1307.5801,1656.0744 C1307.5801,1666.0744 1325.5801,1666.0744 1325.5801,1666.0744 C1325.5801,1666.0744 1343.5801,1666.0744 1343.5801,1656.0744" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1391.6899" x="0" y="155.9888"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1391.6899" y1="155.9888" y2="155.9888"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1391.6899" y1="158.9888" y2="158.9888"/><rect fill="#EEEEEE" height="25.706" style="stroke:#000000;stroke-width:2;" width="183.9881" x="603.8509" y="144.1358"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="166.6081" x="609.8509" y="162.0328">Registration Triggers OTP</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg1"><polygon fill="#181818" points="211.8761,199.5479,221.8761,203.5479,211.8761,207.5479,215.8761,203.5479" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="48.3089" x2="217.8761" y1="203.5479" y2="203.5479"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.5672" x="55.3089" y="197.7389">Submit registration form</text></g><g class="message" data-entity-1="part2" data-entity-2="part4" id="msg2"><polygon fill="#181818" points="521.2023,231.2539,531.2023,235.2539,521.2023,239.2539,525.2023,235.2539" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="223.8761" x2="527.2023" y1="235.2539" y2="235.2539"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.8622" x="230.8761" y="229.4449">POST {name, email, password}</text></g><g class="message" data-entity-1="part4" data-entity-2="part9" id="msg3"><polygon fill="#181818" points="1313.5801,280.6659,1323.5801,284.6659,1313.5801,288.6659,1317.5801,284.6659" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="533.2023" x2="1319.5801" y1="284.6659" y2="284.6659"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70.577" x="540.2023" y="261.1509">Create user</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.8381" x="540.2023" y="278.8569">(emailVerified: false)</text></g><g class="message" data-entity-1="part9" data-entity-2="part4" id="msg4"><polygon fill="#181818" points="544.2023,312.3719,534.2023,316.3719,544.2023,320.3719,540.2023,316.3719" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="538.2023" x2="1324.5801" y1="316.3719" y2="316.3719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.065" x="550.2023" y="310.5629">User created</text></g><g class="message" data-entity-1="part4" data-entity-2="part7" id="msg5"><polygon fill="#181818" points="1046.4902,344.0779,1056.4902,348.0779,1046.4902,352.0779,1050.4902,348.0779" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="533.2023" x2="1052.4902" y1="348.0779" y2="348.0779"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.9141" x="540.2023" y="342.2689">generateOTP(email)</text></g><g class="message" data-entity-1="part7" data-entity-2="part7" id="msg6"><line style="stroke:#181818;stroke-width:1;" x1="1058.4902" x2="1100.4902" y1="397.49" y2="397.49"/><line style="stroke:#181818;stroke-width:1;" x1="1100.4902" x2="1100.4902" y1="397.49" y2="410.49"/><line style="stroke:#181818;stroke-width:1;" x1="1059.4902" x2="1100.4902" y1="410.49" y2="410.49"/><polygon fill="#181818" points="1069.4902,406.49,1059.4902,410.49,1069.4902,414.49,1065.4902,410.49" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.8681" x="1065.4902" y="373.975">Generate 6-digit OTP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.5571" x="1065.4902" y="391.681">Store with 5-min expiry</text></g><g class="message" data-entity-1="part7" data-entity-2="part4" id="msg7"><polygon fill="#181818" points="544.2023,438.196,534.2023,442.196,544.2023,446.196,540.2023,442.196" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="538.2023" x2="1057.4902" y1="442.196" y2="442.196"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.0581" x="550.2023" y="436.387">OTP code</text></g><g class="message" data-entity-1="part4" data-entity-2="part8" id="msg8"><polygon fill="#181818" points="1217.3224,487.608,1227.3224,491.608,1217.3224,495.608,1221.3224,491.608" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="533.2023" x2="1223.3224" y1="491.608" y2="491.608"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.1321" x="540.2023" y="468.093">sendVerificationEmail</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.7051" x="540.2023" y="485.799">(email, otp)</text></g><g class="message" data-entity-1="part8" data-entity-2="part4" id="msg9"><polygon fill="#181818" points="544.2023,519.314,534.2023,523.314,544.2023,527.314,540.2023,523.314" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="538.2023" x2="1228.3224" y1="523.314" y2="523.314"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.196" x="550.2023" y="517.505">Sent</text></g><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg10"><polygon fill="#181818" points="380.4002,568.7261,370.4002,572.7261,380.4002,576.7261,376.4002,572.7261" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="374.4002" x2="532.2023" y1="572.7261" y2="572.7261"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.5231" x="386.4002" y="549.2111">201 "Account created,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.8021" x="386.4002" y="566.9171">verification email sent"</text></g><g class="message" data-entity-1="part3" data-entity-2="part1" id="msg11"><polygon fill="#181818" points="59.3089,600.4321,49.3089,604.4321,59.3089,608.4321,55.3089,604.4321" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="53.3089" x2="368.4002" y1="604.4321" y2="604.4321"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.2571" x="65.3089" y="598.6231">Show OTP input field</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1391.6899" x="0" y="634.2851"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1391.6899" y1="634.2851" y2="634.2851"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1391.6899" y1="637.2851" y2="637.2851"/><rect fill="#EEEEEE" height="25.706" style="stroke:#000000;stroke-width:2;" width="121.3931" x="635.1484" y="622.4321"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="104.0131" x="641.1484" y="640.3291">User Enters OTP</text><g class="message" data-entity-1="part1" data-entity-2="part3" id="msg12"><polygon fill="#181818" points="357.4002,677.8441,367.4002,681.8441,357.4002,685.8441,361.4002,681.8441" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="48.3089" x2="363.4002" y1="681.8441" y2="681.8441"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.6751" x="55.3089" y="676.0351">Enter 6-digit OTP</text></g><g class="message" data-entity-1="part3" data-entity-2="part6" id="msg13"><polygon fill="#181818" points="894.7781,709.5501,904.7781,713.5501,894.7781,717.5501,898.7781,713.5501" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="369.4002" x2="900.7781" y1="713.5501" y2="713.5501"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.5481" x="376.4002" y="707.7411">POST {email, otp}</text></g><g class="message" data-entity-1="part6" data-entity-2="part7" id="msg14"><polygon fill="#181818" points="1046.4902,741.2562,1056.4902,745.2562,1046.4902,749.2562,1050.4902,745.2562" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="906.7781" x2="1052.4902" y1="745.2562" y2="745.2562"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.7121" x="913.7781" y="739.4472">verifyOTP(email, otp)</text></g><path d="M10,760.2562 L72.303,760.2562 L72.303,769.9622 L62.303,779.9622 L10,779.9622 L10,760.2562" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="850.7504" style="stroke:#000000;stroke-width:1.5;" width="1371.6899" x="10" y="760.2562"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.303" x="25" y="775.1532">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="127.9621" x="87.303" y="774.0151">[OTP invalid or expired]</text><g class="message" data-entity-1="part7" data-entity-2="part6" id="msg15"><polygon fill="#181818" points="917.7781,799.6682,907.7781,803.6682,917.7781,807.6682,913.7781,803.6682" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="911.7781" x2="1057.4902" y1="803.6682" y2="803.6682"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28.678" x="923.7781" y="797.8592">false</text></g><g class="message" data-entity-1="part6" data-entity-2="part3" id="msg16"><polygon fill="#181818" points="380.4002,831.3742,370.4002,835.3742,380.4002,839.3742,376.4002,835.3742" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="374.4002" x2="905.7781" y1="835.3742" y2="835.3742"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.2111" x="386.4002" y="829.5652">401 "Invalid or expired OTP"</text></g><g class="message" data-entity-1="part3" data-entity-2="part1" id="msg17"><polygon fill="#181818" points="59.3089,863.0802,49.3089,867.0802,59.3089,871.0802,55.3089,867.0802" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="53.3089" x2="368.4002" y1="867.0802" y2="867.0802"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.8791" x="65.3089" y="861.2712">Show error message</text></g><path d="M20,882.0802 L86.983,882.0802 L86.983,891.7862 L76.983,901.7862 L20,901.7862 L20,882.0802" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="434.5902" style="stroke:#000000;stroke-width:1.5;" width="1351.6899" x="20" y="882.0802"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21.983" x="35" y="896.9772">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="123.9691" x="101.983" y="895.8391">[User requests resend]</text><g class="message" data-entity-1="part1" data-entity-2="part3" id="msg18"><polygon fill="#181818" points="357.4002,921.4923,367.4002,925.4923,357.4002,929.4923,361.4002,925.4923" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="48.3089" x2="363.4002" y1="925.4923" y2="925.4923"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.7261" x="55.3089" y="919.6833">Click "Resend OTP"</text></g><g class="message" data-entity-1="part3" data-entity-2="part5" id="msg19"><polygon fill="#181818" points="704.8997,953.1983,714.8997,957.1983,704.8997,961.1983,708.8997,957.1983" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="369.4002" x2="710.8997" y1="957.1983" y2="957.1983"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79.1311" x="376.4002" y="951.3893">POST {email}</text></g><g class="message" data-entity-1="part5" data-entity-2="part9" id="msg20"><polygon fill="#181818" points="1313.5801,1002.6103,1323.5801,1006.6103,1313.5801,1010.6103,1317.5801,1006.6103" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="716.8997" x2="1319.5801" y1="1006.6103" y2="1006.6103"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.1961" x="723.8997" y="983.0953">Check user exists</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.5211" x="723.8997" y="1000.8013">and not yet verified</text></g><g class="message" data-entity-1="part9" data-entity-2="part5" id="msg21"><polygon fill="#181818" points="727.8997,1034.3163,717.8997,1038.3163,727.8997,1042.3163,723.8997,1038.3163" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="721.8997" x2="1324.5801" y1="1038.3163" y2="1038.3163"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.2111" x="733.8997" y="1032.5073">User found</text></g><g class="message" data-entity-1="part5" data-entity-2="part7" id="msg22"><polygon fill="#181818" points="1046.4902,1066.0223,1056.4902,1070.0223,1046.4902,1074.0223,1050.4902,1070.0223" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="716.8997" x2="1052.4902" y1="1070.0223" y2="1070.0223"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.9141" x="723.8997" y="1064.2133">generateOTP(email)</text></g><g class="message" data-entity-1="part7" data-entity-2="part7" id="msg23"><line style="stroke:#181818;stroke-width:1;" x1="1058.4902" x2="1100.4902" y1="1119.4344" y2="1119.4344"/><line style="stroke:#181818;stroke-width:1;" x1="1100.4902" x2="1100.4902" y1="1119.4344" y2="1132.4344"/><line style="stroke:#181818;stroke-width:1;" x1="1059.4902" x2="1100.4902" y1="1132.4344" y2="1132.4344"/><polygon fill="#181818" points="1069.4902,1128.4344,1059.4902,1132.4344,1069.4902,1136.4344,1065.4902,1132.4344" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.5791" x="1065.4902" y="1095.9194">Invalidate old OTP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.8321" x="1065.4902" y="1113.6254">Generate new 6-digit OTP</text></g><g class="message" data-entity-1="part7" data-entity-2="part5" id="msg24"><polygon fill="#181818" points="727.8997,1160.1404,717.8997,1164.1404,727.8997,1168.1404,723.8997,1164.1404" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="721.8997" x2="1057.4902" y1="1164.1404" y2="1164.1404"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.8681" x="733.8997" y="1158.3314">New OTP code</text></g><g class="message" data-entity-1="part5" data-entity-2="part8" id="msg25"><polygon fill="#181818" points="1217.3224,1209.5524,1227.3224,1213.5524,1217.3224,1217.5524,1221.3224,1213.5524" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="716.8997" x2="1223.3224" y1="1213.5524" y2="1213.5524"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.1321" x="723.8997" y="1190.0374">sendVerificationEmail</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.7051" x="723.8997" y="1207.7434">(email, otp)</text></g><g class="message" data-entity-1="part8" data-entity-2="part5" id="msg26"><polygon fill="#181818" points="727.8997,1241.2584,717.8997,1245.2584,727.8997,1249.2584,723.8997,1245.2584" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="721.8997" x2="1228.3224" y1="1245.2584" y2="1245.2584"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.196" x="733.8997" y="1239.4494">Sent</text></g><g class="message" data-entity-1="part5" data-entity-2="part3" id="msg27"><polygon fill="#181818" points="380.4002,1272.9645,370.4002,1276.9645,380.4002,1280.9645,376.4002,1276.9645" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="374.4002" x2="715.8997" y1="1276.9645" y2="1276.9645"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.9091" x="386.4002" y="1271.1555">200 "OTP resent"</text></g><g class="message" data-entity-1="part3" data-entity-2="part1" id="msg28"><polygon fill="#181818" points="59.3089,1304.6705,49.3089,1308.6705,59.3089,1312.6705,55.3089,1308.6705" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="53.3089" x2="368.4002" y1="1308.6705" y2="1308.6705"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.1021" x="65.3089" y="1302.8615">Show success message</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="10" x2="1381.6899" y1="1324.6705" y2="1324.6705"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="58.4096" x="15" y="1336.4294">[OTP valid]</text><g class="message" data-entity-1="part7" data-entity-2="part6" id="msg29"><polygon fill="#181818" points="917.7781,1360.3584,907.7781,1364.3584,917.7781,1368.3584,913.7781,1364.3584" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="911.7781" x2="1057.4902" y1="1364.3584" y2="1364.3584"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="25.428" x="923.7781" y="1358.5494">true</text></g><g class="message" data-entity-1="part7" data-entity-2="part7" id="msg30"><line style="stroke:#181818;stroke-width:1;" x1="1058.4902" x2="1100.4902" y1="1396.0644" y2="1396.0644"/><line style="stroke:#181818;stroke-width:1;" x1="1100.4902" x2="1100.4902" y1="1396.0644" y2="1409.0644"/><line style="stroke:#181818;stroke-width:1;" x1="1059.4902" x2="1100.4902" y1="1409.0644" y2="1409.0644"/><polygon fill="#181818" points="1069.4902,1405.0644,1059.4902,1409.0644,1069.4902,1413.0644,1065.4902,1409.0644" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.1271" x="1065.4902" y="1390.2554">Delete used OTP</text></g><g class="message" data-entity-1="part6" data-entity-2="part9" id="msg31"><polygon fill="#181818" points="1313.5801,1454.4764,1323.5801,1458.4764,1313.5801,1462.4764,1317.5801,1458.4764" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="906.7781" x2="1319.5801" y1="1458.4764" y2="1458.4764"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75.1531" x="913.7781" y="1434.9614">Update user</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.5881" x="913.7781" y="1452.6674">(emailVerified: true)</text></g><g class="message" data-entity-1="part9" data-entity-2="part6" id="msg32"><polygon fill="#181818" points="917.7781,1486.1824,907.7781,1490.1824,917.7781,1494.1824,913.7781,1490.1824" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="911.7781" x2="1324.5801" y1="1490.1824" y2="1490.1824"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52.806" x="923.7781" y="1484.3734">Updated</text></g><g class="message" data-entity-1="part6" data-entity-2="part3" id="msg33"><polygon fill="#181818" points="380.4002,1517.8885,370.4002,1521.8885,380.4002,1525.8885,376.4002,1521.8885" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="374.4002" x2="905.7781" y1="1521.8885" y2="1521.8885"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.8721" x="386.4002" y="1516.0795">200 "Email verified"</text></g><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg34"><polygon fill="#181818" points="234.8761,1549.5945,224.8761,1553.5945,234.8761,1557.5945,230.8761,1553.5945" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="228.8761" x2="368.4002" y1="1553.5945" y2="1553.5945"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.5241" x="240.8761" y="1547.7855">router.push('/login')</text></g><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg35"><polygon fill="#181818" points="59.3089,1599.0065,49.3089,1603.0065,59.3089,1607.0065,55.3089,1603.0065" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="53.3089" x2="222.8761" y1="1603.0065" y2="1603.0065"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.3161" x="65.3089" y="1579.4915">Redirect to login page</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.1471" x="65.3089" y="1597.1975">with success message</text></g><?plantuml-src bLHDRnen4BtxLuou94XGqiy34f52e56afa4G8bNYugo7nUfYRxrUQ5JbltTih_SZQLhrjkkPUJFpthEjj1d22d-Kg1A4cUIfuVinpFTSPd1xju1xD78h4swbLd2wlXoUlUypnXEh3VJM1PeUy0BMBEV6oaJcN5deJOq-nj2q6rfYAWkB1XOyHP-mN7Gp5hUhEnZnN8vuQNSZKnM4tFdLNvErpKS5Ak6JL_Elitzc7zn-Zpx_Vhwy_lojM-4eMA4vo2GCI__TXC1KEsL-St7zXGbk-GCl47etMgLwDlMnsPInoGG22IQGUcTacgBns32PCBQ6uJbCnx0g7_RIWcadRxNPiwbB82h6u1VwfVWU1u1kaW7al2YEseWdHXakSKPGbmQvHIX9b8qwzPb1M1HZsFAim3wR4Mp4TS92uej4nA7nnf2YGXe5wIV0z9aREuQlgZ1y6WgPql1qkb4hCWl2KTeTV1pkfGBycKlp62fZI_UJQ86ndQTn34xDjWSztt670P24VUPJ6wGLAXjGt0bDzUxiBVGkaaINf5YrrM2Z3crhUppNpVROCeor9gYTFlh9fCfB2yHN9ho2dg2viYzqS_tyUPi2ZtXU6Iogrcpmn4AafZ6OikQuMfFnp5R377Wc1T0Lz4oIHW2HpDZ4gqhd4RgQxOFZule5W2llKVQprT4OojbZKT1jPHJNkGsx6_Tc5BQW3oSHXG1g0YupcNntTzs58dG0F_VNiiF1am-wuzgkEwHwvrQQZynVR1Gd8AKjFA8Dz4WCJIlR1bG_sfPq5XtCrwphSjhshNXn1jQP2EQjBQtmsD6qBgwxVyLZO-Ds___miYjh_1nmlQ4RlDhLP-5zyWhOXkAMVaMP92HUhI20queXMSDFwjVzWtciAP5rkPbXXk494TNwZMcTPkjSlFx4E3otMoLMR1Dgn4kN-jt2qnh5ZkxqJwFH9LsnDtbPx4vFHfbEfJfn-DEu_H85sJgnO3NuCBsBAMwKVuIUi-8u-Gq0?></g></svg>